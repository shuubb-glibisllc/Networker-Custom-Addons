<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Google Connect Wizard Form View -->
    <record id="view_google_connect_wizard_form" model="ir.ui.view">
        <field name="name">google.connect.wizard.form</field>
        <field name="model">google.connect.wizard</field>
        <field name="arch" type="xml">
            <form string="Connect Google Account">
                <div class="alert alert-info mb-3" role="alert">
                    <h4>Google Meet Integration</h4>
                    <p>Connect your Google account to create Google Meet meetings directly from Odoo calendar events.</p>
                </div>
                
                <group>
                    <field name="user_id" readonly="1"/>
                    <field name="google_auth_status" readonly="1"/>
                    <field name="google_auth_email" readonly="1" invisible="google_auth_status != 'connected'"/>
                </group>
                
                <div invisible="google_auth_status == 'connected'">
                    <div class="alert alert-warning" role="alert">
                        <p><strong>No Google account connected</strong></p>
                        <p>Click the button below to connect your Google account.</p>
                    </div>
                </div>
                
                <div invisible="google_auth_status != 'connected'">
                    <div class="alert alert-success" role="alert">
                        <p><strong>âœ… Google account connected successfully!</strong></p>
                        <p>You can now create Google Meet meetings from calendar events.</p>
                    </div>
                </div>
                
                <footer>
                    <button name="action_connect_google" string="Connect Google Account" type="object" class="btn-primary" invisible="google_auth_status == 'connected'"/>
                    <button name="action_disconnect_google" string="Disconnect" type="object" class="btn-warning" invisible="google_auth_status != 'connected'" confirm="Are you sure you want to disconnect your Google account?"/>
                    <button name="action_open_user_preferences" string="Open User Preferences" type="object" class="btn-secondary"/>
                    <button string="Cancel" class="btn-secondary" special="cancel"/>
                </footer>
            </form>
        </field>
    </record>

    <!-- Google Connect Wizard Action -->
    <record id="action_google_connect_wizard" model="ir.actions.act_window">
        <field name="name">Connect Google Account</field>
        <field name="res_model">google.connect.wizard</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
        <field name="view_id" ref="view_google_connect_wizard_form"/>
    </record>

    <!-- Add to Calendar Event form as a button -->
    <record id="view_calendar_event_form_google_connect" model="ir.ui.view">
        <field name="name">calendar.event.form.google.connect</field>
        <field name="model">calendar.event</field>
        <field name="inherit_id" ref="calendar.view_calendar_event_form"/>
        <field name="arch" type="xml">
            <field name="videocall_location" position="after">
                <div class="alert alert-info mt-2" role="alert" invisible="videocall_source != 'discuss' or google_meet_url">
                    <p><strong>ðŸ’¡ Tip:</strong> Connect your Google account to create real Google Meet meetings instead of Odoo meetings.</p>
                    <button name="%(action_google_connect_wizard)d" string="Connect Google Account" type="action" class="btn btn-sm btn-primary"/>
                </div>
            </field>
        </field>
    </record>

</odoo>